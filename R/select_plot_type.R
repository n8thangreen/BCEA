
#' Choose Graphical Engine
#'
#' @keywords dplot
#' 
select_plot_type <- function(graph) {
  
  if (missing(graph)) graph <- "base"
  
  graph_lup <- c(base = 1, ggplot2 = 2, plotly =3)
  graph_type <- graph_lup[graph]
  
  is_req_pkgs <- map_lgl(c("ggplot2", "grid"), requireNamespace, quietly = TRUE)
  
  if (graph_type == 2 && !all(is_req_pkgs)) {
    warning(
      "Packages ggplot2 and grid not found;
      plot will be rendered using base graphics.", call. = FALSE)
    graph_type <- 1}
  
  if (graph_type == 3 && !requireNamespace("plotly", quietly = TRUE)) {
    warning(
      "Package plotly not found;
      plot will be rendered using base graphics.", call. = FALSE)
    graph_type <- 1}
  
  graph_type
}


#
is_baseplot <- function(graph) {
  
  select_plot_type(graph) == 1
}

#
is_ggplot <- function(graph) {
  
  select_plot_type(graph) == 2
}

#
is_plotly <- function(graph) {
  
  select_plot_type(graph) == 3
}
